<!DOCTYPE html>
<html>
	<head>
		 <style>html {
	background: #123;
	color: #cde;
	font-size: 13pt;
	padding: 1em 2em 2em;
	position: relative;
	min-height: calc(100vh - 3em);
	tab-size: 4;
}

body {
	margin: 0;
}

.faint {
	color: #678;
}

.error {
	color: #d65;
}

input, textarea {
	background: #012;
	color: #def;
	font-size: 100%;
}

textarea {
	resize: none;
	width: 100%;
	min-height: 2em;
	max-height: 50vh;
}

button {
	background: #627;
	color: #bcd;
	padding: 0.5em;
	cursor: pointer;
	vertical-align: middle;
}

a {
	color: #b7c;
}

#app-title {
	margin: 0;
}

#app-inputs {
	display: flex;
	flex-wrap: wrap;
	margin: 0 -1em;
}

#app-inputs > * {
	flex-grow: 1;
	min-width: calc(min(36em, 100vw - 5em));
	margin: 0 1em;
}

#app-inputs h2 {
	line-height: 2;
}

h2 {
	margin: 0.5em 0 0.2em;
}

#output {
	white-space: pre;
	background: #234;
	padding: 1em;
	font-family: monospace;
}

article {
	max-width: 48em;
	margin: 0 auto;
}

.example {
	display: flex;
	flex-wrap: wrap;
	justify-content: space-around;
}

.example > * {
	flex: auto;
	margin: 0.3em;
	display: flex;
	flex-direction: column;
}

.example h5 {
	margin: 0;
}

.example pre {
	background: #0008;
	padding: 0.7em;
	font-size: 90%;
	flex-grow: 1;
	margin: 0.5em 0;
}

aside {
	margin-bottom: 2em;
}

code {
	background: #0008;
}

dfn {
	background: #323;
}

footer {
	position: absolute;
	height: 2em;
	bottom: 0;
	white-space: nowrap;
	text-overflow: ellipsis;
	overflow: hidden;
	width: calc(100vw - 4em);
}

#notification-area {
	position: fixed;
	z-index: 1;
	left: 2em;
	bottom: 3em;
}

.notification {
	background: #9b9a5c;
	color: #012;
	padding: 0.5em;
	border-radius: 1em;
	margin: 0.5em;
}

.notification a {
	color: #415;
}

.notification-close,
.notification button {
	margin-inline-end: 1em;
	margin-inline-start: 1em;
	cursor: pointer;
}
</style>
		<link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAPUExURREiM3Z2dkxMTCEhIWYid8rw4igAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAaSURBVBjTYyAJCIKAEIyhDGS4gIAxtRgMDACLbA6fu+etBAAAAABJRU5ErkJggg==">
		<title>Text Munge</title>
	</head>
	<body>
		<input type="hidden" id="build-date" value="12/3/2021, 8:01:20 PM">
		<main></main>
		 <script>(()=>{function Te(h){return h.element instanceof HTMLElement&&typeof h.refs=="object"}var Q=class{constructor(t){this.element=t.element,this.refs=t.refs}get classList(){return this.element.classList}get id(){return this.element.id}set id(t){this.element.id=t}get hidden(){return this.element.hidden}set hidden(t){this.element.hidden=t}get innerText(){return this.element.innerText}set innerText(t){this.element.innerText=t}get contenteditable(){return this.element.contentEditable}set contenteditable(t){this.element.contentEditable=t}get spellcheck(){return this.element.spellcheck}set spellcheck(t){this.element.spellcheck=t}get tabIndex(){return this.element.tabIndex}set tabIndex(t){this.element.tabIndex=t}get title(){return this.element.title}set title(t){this.element.title=t}addEventListener(t,i){this.element.addEventListener(t,i)}querySelector(t){return this.element.querySelector(t)}querySelectorAll(t){return this.element.querySelectorAll(t)}focus(t){this.element.focus(t)}blur(){this.element.blur()}};function e(h,t){let i={},n,r;if(typeof h=="function"?n=(r=new h(t)).element:n=document.createElement(h),t?.children){let s=t?.children??[];delete t.children,Array.isArray(s)||(s=[s]);for(let c of s)Te(c)?(Object.assign(i,c.refs),n.append(c.element)):n.append(c)}for(let s in t)s==="ref"?i[t[s]]=r??n:s in n?n[s]=t[s]:n.setAttribute(s,t[s]);return{element:n,refs:i}}var l=e,Pe=class extends Q{constructor(t){super(e(t.tag??"ul"));this.items=[]}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.get(t)}get length(){return this.items.length}push(t){this.items.push(t),this.element.appendChild(t.element)}removeAt(t){let i=this.items.splice(t,1);return this.element.removeChild(this.element.children[t]),i[0]}insertAt(t,i){this.items.splice(t,0,i),this.element.insertBefore(i.element,this.element.children[t])}get(t){return this.items[t]}set(t,i){this.items[t]=i,this.element.children[t].replaceWith(i.element)}map(t){let i=[];for(let n=0;n<this.length;n++)i.push(t(this.get(n),n,this));return i}filter(t){let i=[];for(let n=0;n<this.length;n++){let r=this.get(n);t(r)&&i.push(r)}return i}toArray(){return this.map(t=>t)}};function Ie(h){return h.element instanceof HTMLElement&&typeof h.refs=="object"}var w=class{constructor(t){this.element=t.element,this.refs=t.refs}get classList(){return this.element.classList}get id(){return this.element.id}set id(t){this.element.id=t}get hidden(){return this.element.hidden}set hidden(t){this.element.hidden=t}get innerText(){return this.element.innerText}set innerText(t){this.element.innerText=t}get contenteditable(){return this.element.contentEditable}set contenteditable(t){this.element.contentEditable=t}get spellcheck(){return this.element.spellcheck}set spellcheck(t){this.element.spellcheck=t}get tabIndex(){return this.element.tabIndex}set tabIndex(t){this.element.tabIndex=t}get title(){return this.element.title}set title(t){this.element.title=t}addEventListener(t,i){this.element.addEventListener(t,i)}querySelector(t){return this.element.querySelector(t)}querySelectorAll(t){return this.element.querySelectorAll(t)}focus(t){this.element.focus(t)}blur(){this.element.blur()}};function Ne(h,t){var i;let n={},r,s;if(typeof h=="function"?r=(s=new h(t)).element:r=document.createElement(h),t==null?void 0:t.children){let c=(i=t==null?void 0:t.children)!==null&&i!==void 0?i:[];delete t.children,Array.isArray(c)||(c=[c]);for(let y of c)Ie(y)?(Object.assign(n,y.refs),r.append(y.element)):r.append(y)}for(let c in t)c==="ref"?n[t[c]]=s??r:c in r?r[c]=t[c]:r.setAttribute(c,t[c]);return{element:r,refs:n}}var Me=class extends w{constructor(t){var i;super(Ne((i=t.tag)!==null&&i!==void 0?i:"ul"));this.items=[]}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.get(t)}get length(){return this.items.length}push(t){this.items.push(t),this.element.appendChild(t.element)}removeAt(t){let i=this.items.splice(t,1);return this.element.removeChild(this.element.children[t]),i[0]}insertAt(t,i){this.items.splice(t,0,i),this.element.insertBefore(i.element,this.element.children[t])}get(t){return this.items[t]}set(t,i){this.items[t]=i,this.element.children[t].replaceWith(i.element)}map(t){let i=[];for(let n=0;n<this.length;n++)i.push(t(this.get(n),n,this));return i}filter(t){let i=[];for(let n=0;n<this.length;n++){let r=this.get(n);t(r)&&i.push(r)}return i}toArray(){return this.map(t=>t)}};var T=class{constructor(t){typeof t=="string"?this.instructions=Array.from(t.matchAll(/".*?"|\S+/sg)).map(i=>i[0]):this.instructions=t}evaluate(t,i,n=[]){var r,s,c,y,b,P,N,x,k,j,M,z,_,B,F,H,Y;function m(...o){for(let u of o)n.unshift(typeof u=="string"?u:u.toString())}function a(o=0){var u,g;return o===0?(u=n.shift())!==null&&u!==void 0?u:"":(g=n.splice(o,1)[0])!==null&&g!==void 0?g:""}let X=/^ *-?\d+ *$/;function O(o,u){let g=a(),U=a();X.test(U)&&X.test(g)?m(u(BigInt(U),BigInt(g))):m(o(Number(U),Number(g)))}function J(){let o=I.shift();if(!(o instanceof T))throw"Expected proc block, got "+o;return o}function se(){let o=I[0];if(o instanceof T)return I.shift(),o}function K(o){var u;return(u=n[o!=null?o:0])!==null&&u!==void 0?u:""}function Z(o){return!["","0"].includes(o)}let I=this.instructions.slice(),S,A;for(;S=I.shift();){if(S instanceof T)throw Error("Bare proc blocks don't do anything (yet?)");if(/^-?\d+(\.\d*)?$/.test(S))m(S);else if(S.startsWith('"'))m(JSON.parse(S));else if(A=/^(set|get|push|pop|cons|uncons|join|rev|for|do|getat|setat|inc|dec|empty|count|sort)\((\w+)\)$/.exec(S))I.unshift(JSON.stringify(A[2]),A[1]);else if(A=/^\$(\d+)$/.exec(S))I.unshift(JSON.stringify(A[1]),"group");else switch(S){case"_":m(t.value);break;case"len":m(a().length);break;case"swap":m(a(),a());break;case"copy":m(K());break;case"drop":a();break;case"clear":n.splice(0);break;case"dump":console.log(JSON.parse(JSON.stringify({instructions:I,stack:n,arrays:[...i.arrays.entries()],registers:[...i.registers.entries()],mungers:[...i.mungers.entries()]})));break;case"group":m((s=(r=t.groups)===null||r===void 0?void 0:r[Number(a())-1])!==null&&s!==void 0?s:"");break;case"max":n.length>=2&&m(Math.max(...[a(),a()].filter(o=>o).map(Number)));break;case"min":n.length>=2&&m(Math.min(...[a(),a()].filter(o=>o).map(Number)));break;case">":m(a(1)>a()?1:0);break;case"<":m(a(1)<a()?1:0);break;case">>":O((o,u)=>o>u?1:0,(o,u)=>o>u?1:0);break;case"<<":O((o,u)=>o<u?1:0,(o,u)=>o<u?1:0);break;case">=":O((o,u)=>o>=u?1:0,(o,u)=>o>=u?1:0);break;case"<=":O((o,u)=>o<=u?1:0,(o,u)=>o<=u?1:0);break;case"=":m(a()==a()?1:0);break;case"+":O((o,u)=>o+u,(o,u)=>o+u);break;case"-":O((o,u)=>o-u,(o,u)=>o-u);break;case"%":O((o,u)=>o%u,(o,u)=>o%u);break;case"*":O((o,u)=>o*u,(o,u)=>o*u);break;case"/":m(Number(a(1))/Number(a()));break;case"rep":m(Array(Number(a())).fill(a()).join(""));break;case"floor":m(Math.floor(Number(a())));break;case"not":m(Number(a())?0:1);break;case"or":{let o=a(1),u=a();m(Z(o)?o:u);break}case"cat":m(a(1)+a());break;case"rpad":m(a(1).padEnd(Number(a())));break;case"lpad":m(a(1).padStart(Number(a())));break;case"index":m(a(1).indexOf(a()));break;case"lower":m(a().toLowerCase());break;case"upper":m(a().toUpperCase());break;case"skip":m(a(1).substring(Number(a())));break;case"take":m(a(1).substring(0,Number(a())));break;case"ord":m((c=a().codePointAt(0))!==null&&c!==void 0?c:0);break;case"chr":m(String.fromCodePoint(Number(a())));break;case"hex":m(Number(a()).toString(16));break;case"unhex":m(parseInt(a(),16));break;case"set":i.registers.set(a(),K());break;case"get":m((y=i.registers.get(a()))!==null&&y!==void 0?y:"");break;case"inc":{let o=a();i.registers.set(o,(Number((b=i.registers.get(o))!==null&&b!==void 0?b:0)+1).toString());break}case"dec":{let o=a();i.registers.set(o,(Number((P=i.registers.get(o))!==null&&P!==void 0?P:0)-1).toString());break}case"push":{let o=a();i.arrays.has(o)||i.arrays.set(o,[]),i.arrays.get(o).push(a());break}case"pop":m((x=(N=i.arrays.get(a()))===null||N===void 0?void 0:N.pop())!==null&&x!==void 0?x:"");break;case"cons":{let o=a();i.arrays.has(o)||i.arrays.set(o,[]),i.arrays.get(o).unshift(a());break}case"uncons":m((j=(k=i.arrays.get(a()))===null||k===void 0?void 0:k.shift())!==null&&j!==void 0?j:"");break;case"join":m((z=(M=i.arrays.get(a()))===null||M===void 0?void 0:M.join(a()))!==null&&z!==void 0?z:"");break;case"rev":(_=i.arrays.get(a()))===null||_===void 0||_.reverse();break;case"sort":(B=i.arrays.get(a()))===null||B===void 0||B.sort();break;case"empty":i.arrays.set(a(),[]);break;case"count":m((H=(F=i.arrays.get(a()))===null||F===void 0?void 0:F.length)!==null&&H!==void 0?H:0);break;case"if":{let o=a(),u=J(),g=se();Z(o)?u.evaluate(t,i,n):g&&g.evaluate(t,i,n);break}case"for":{let o=(Y=i.arrays.get(a()))!==null&&Y!==void 0?Y:[],u=J();for(let g of o)u.evaluate({value:g,groups:[]},i,n);break}case"times":{let o=Number(a()),u=J();for(let g=0;g<o;g++)u.evaluate({value:t.value,groups:t.groups},i,n);break}case"do":{let o=a(),u=i.mungers.get(o);if(u==null)throw Error(`Named munger reference: '${o}' could not be resolved.`);u instanceof T?u.evaluate(t,i,n):m(typeof u=="string"?u:u.apply(Object.assign(Object.assign({},t),{value:a()}),i));break}default:throw"unrecognized instruction "+S}}return n.slice().reverse().join("")}};var _e=new Map;function L(h,t,i=_e){let n=h.replace(/\r\n?/g,`
`);return $({value:n,groups:[]},t,{registers:new Map,arrays:new Map,mungers:i})}function $(h,t,i){return typeof t=="string"?t:t instanceof T?t.evaluate(h,i):t.apply(h,i)}function Ae(h,t,i){if(typeof t=="string"){let n=i>h.length?-1:h.indexOf(t,i);if(n>=0)return{index:n,value:t,groups:[]}}else if(t instanceof RegExp){if(!t.global)throw"gotta be global";t.lastIndex=i;let n=t.exec(h);if(n)return{index:n.index,value:n[0],groups:n.slice(1)}}else throw`Unimplemented locator type ${t}`}function ve(h){return typeof h=="object"&&"locatorName"in h}var ee=class{constructor(t,...i){this.howMany=t,this.rules=i}apply(t,i){let n=-1,r=0,s=[],c=-1,y,b,P=this.rules.map(x=>ve(x.locator)?i.registers.get(x.locator.locatorName):x.locator).filter(x=>x!=null),N=P.map(()=>({value:"",index:-1,groups:[]}));for(let x=0;r<=t.value.length;){b=void 0,y=-1;for(let k=0;k<P.length;k++){let j=N[k];if(j==null)continue;let M=k<=c?Math.max(n+1,r):r;N[k]=j=Ae(t.value,P[k],M),j!=null&&(b==null||j.index<b.index)&&(b=j,y=k)}if(b==null||(s.push(t.value.substring(r,b.index),$(b,this.rules[y].replace,i)),c=y,n=b.index,r=b.index+b.value.length,++x===this.howMany))break}return s.join("")+t.value.substring(r)}repeat(){return new W(this)}},W=class{constructor(t){this.munger=t}apply(t,i){let n=t.value,r=$(t,this.munger,i);for(;n!==r;)n=r,r=$({value:r,groups:[]},this.munger,i);return r}},te=class{constructor(t,...i){this.howMany=t,this.steps=i}apply(t,i){let n=t.value,r=0;for(let s of this.steps){let c=$({value:n,groups:[]},s,i);if(c!==n&&++r===this.howMany)return c;n=c}return n}repeat(){return new W(this)}},ce=class{constructor(t){this.rule=t}apply(t,i){let n=t.value,r,s;if(this.rule.locator instanceof RegExp)for(let c of n.matchAll(this.rule.locator))s=c.index,r={value:c[0],groups:c.slice(1)};else{let c=ve(this.rule.locator)?i.registers.get(this.rule.locator.locatorName):this.rule.locator;if(c==null)return n;s=n.lastIndexOf(c),s>=0&&(r={value:c,groups:[]})}return!r||s==null?n:n.substring(0,s)+$(r,this.rule.replace,i)+n.substring(s+r.value.length)}},ue=class{constructor(t){this.munger=t}apply(t,i){return $(t,this.munger,i),t.value}};var ie=class{constructor(t,i,n,r){this.message=t,this.position=i,this.line=n,this.column=r}};function q(h){let t=0,i=/.*/y;function n(d){let p=h.substring(0,t),f=1,E=t+1;for(let R of p.matchAll(/\n/g)){if(R.index==null)throw Error("Internal error: RegExp match doesn't have index");if(R.index>t)break;++f,E=t-R.index+1}console.error(`${f}:${E} `+d),i.lastIndex=t;let D=i.exec(h);throw D&&console.error("Upcoming: "+D[0]),new ie(d,t,f,E)}let r=/(?:\s|!.*)+/y;function s(d){var p,f;d.sticky||n(`Token pattern ${d} not sticky.`),r.lastIndex=t,t+=(f=(p=r.exec(h))===null||p===void 0?void 0:p[0].length)!==null&&f!==void 0?f:0,d.lastIndex=t;let E=d.exec(h);if(E)return t+=E[0].length,E}let c=/"(?:[^\\"]|\\.)*"/y;function y(){let d=s(c);if(d)return JSON.parse(d[0])}let b=/'(?:[^\\']|\\.)*'/y;function P(){let d=s(b);if(d)return JSON.parse(d[0].replace(/^'|'$/g,'"'))}let N=/\/((?:[^\\\n/]|\\.)+)\/([ism]*)/y;function x(){let d=s(N);if(d)return new RegExp(d[1],d[2]+"g")}let k=/get\((\w+)\)/y;function j(){let d=s(k);if(d!=null)return{locatorName:d[1]}}function M(){var d,p;return(p=(d=P())!==null&&d!==void 0?d:x())!==null&&p!==void 0?p:j()}let z=/=>/y;function _(){let d=M();if(d==null)return;s(z)||n("Expected '=>'");let p=C();return p==null&&n("Expected rule munger"),{locator:d,replace:p}}function B(){let d=_();if(d!=null)return new ee(Number.POSITIVE_INFINITY,d)}let F=/(\d+)?\(/y,H=/\)/y;function Y(){let d=s(F);if(!d)return;let p=[],f;for(;f=_();)p.push(f);return s(H)||n("Expected rule or ')'"),new ee(d[1]?Number(d[1]):Number.POSITIVE_INFINITY,...p)}let m=/(\d+)?#\(/y,a=/\)/y;function X(){let d=s(m);if(!d)return;let p=[],f;for(;(f=C())!=null;)p.push(f);return s(a)||n("Expected munger or ')'"),new te(d[1]?Number(d[1]):Number.POSITIVE_INFINITY,...p)}let O=/{/y,J=/"(?:[^\\"]|\\.)*"|(?:(?!["{}])\S)+/y,se=/}/y;function K(){if(!s(O))return;let d=[],p;for(;;){if(p=s(J)){d.push(p[0]);continue}let f=K();if(f){d.push(f);continue}break}return s(se)||n("Expected instruction or '}'"),new T(d)}let Z=/@/y;function I(){if(!s(Z))return;let d=C();return d==null&&n("Expected munger after '@' decorator"),new W(d)}let S=/eat\b/y;function A(){if(!s(S))return;let d=C();return d==null&&n("Expected munger after 'eat' decorator"),new te(Number.POSITIVE_INFINITY,d,"")}let o=/fx\b/y;function u(){if(!s(o))return;let d=C();return d==null&&n("Expected munger after 'fx' decorator"),new ue(d)}let g=/last\s*\(/y,U=/\)/y;function ke(){if(!s(g))return;let d=_();return d==null&&n("Expected rule after 'last('"),s(U)||n("Expected ')' to close 'last('"),new ce(d)}let V=new Map,Se=/do\((\w+)\)/y;function we(){let d=s(Se);if(d==null)return;let p=d[1];return V.has(p)||n(`Undeclared munger reference: '${p}'`),V.get(p)}function C(){var d,p,f,E,D,R,de,le,ae;return(ae=(le=(de=(R=(D=(E=(f=(p=(d=Y())!==null&&d!==void 0?d:X())!==null&&p!==void 0?p:I())!==null&&f!==void 0?f:ke())!==null&&E!==void 0?E:A())!==null&&D!==void 0?D:u())!==null&&R!==void 0?R:K())!==null&&de!==void 0?de:B())!==null&&le!==void 0?le:y())!==null&&ae!==void 0?ae:we()}let je=/def\((\w+)\)/y;function Ee(){let d=s(je);if(d==null)return;let p=d[1],f=C();return f==null&&n("Expected munger definition after named declaration"),{name:p,munger:f}}for(;;){let d=Ee();if(d==null)break;V.has(d.name)&&n(`Duplicate def() for ${d.name}`),V.set(d.name,d.munger)}let Oe=/$/y,fe=C();return fe==null&&n("Expected munger definition"),s(Oe)||n("Expected EOF following munger"),{munger:fe,named:V}}var ne=class extends w{constructor(t){super(e("textarea",{spellcheck:!1,onkeydown:i=>this.keydown(i),oninput:()=>this.autosize()},void 0));this.allowComments=t.allowComments,window.addEventListener("resize",()=>this.autosize())}get textarea(){return this.element}get value(){return this.textarea.value}set value(t){this.textarea.value=t,this.autosize()}get selectionStart(){return this.textarea.selectionStart}set selectionStart(t){this.textarea.selectionStart=t}get selectionEnd(){return this.textarea.selectionEnd}set selectionEnd(t){this.textarea.selectionEnd=t}get selection(){return this.value.substring(this.selectionStart,this.selectionEnd)}keydown(t){var i,n;if(t.key==="Tab")if(t.preventDefault(),this.selectionStart!==this.selectionEnd)this.expandSelectionToLine(),t.shiftKey?this.replaceSelection(/^\t/mg,""):this.replaceSelection(/^(.)/mg,"	$1");else if(t.shiftKey){let r=this.selectionStart,s=this.value.lastIndexOf(`
`,r-1)+1;this.value[s]==="	"&&(this.value=this.value.substring(0,s)+this.value.substring(s+1),this.selectionEnd=this.selectionStart=Math.max(r-1,s))}else{let r=this.selectionStart;this.value=this.value.substring(0,r)+"	"+this.value.substring(r),this.selectionEnd=this.selectionStart=r+1}else if(t.key==="/"&&t.ctrlKey&&this.allowComments)if(t.preventDefault(),this.selectionStart===this.selectionEnd){let r=this.selectionStart,c=this.value.lastIndexOf(`
`,r-1)+1;for(;" 	".includes(this.value[c]);c++);this.value[c]==="!"?this.value[c+1]===" "?(this.value=this.value.substring(0,c)+this.value.substring(c+2),this.selectionEnd=this.selectionStart=r>c?Math.max(c,r-2):r):(this.value=this.value.substring(0,c)+this.value.substring(c+1),this.selectionEnd=this.selectionStart=r>c?r-1:r):(this.value=this.value.substring(0,c)+"! "+this.value.substring(c),this.selectionEnd=this.selectionStart=r>c?r+2:r)}else this.expandSelectionToLine(),this.selection.split(/\n/g).every(s=>/^\s*!/.test(s)||s.trim()==="")?this.replaceSelection(/^(\s*)! ?/mg,"$1"):this.replaceSelection(/^(\s*)(?!$)/mg,"$1! ");else if(t.key==="{"||t.key==="("){t.preventDefault();let r={"(":")","{":"}"}[t.key];if(this.selection){let s=this.selectionStart,c=this.selectionEnd;this.value=this.value.substring(0,s)+t.key+this.selection+r+this.value.substring(c),this.selectionStart=s+1,this.selectionEnd=c+1}else{let s=this.selectionStart;this.value=this.value.substring(0,s)+t.key+r+this.value.substring(s),this.selectionStart=this.selectionEnd=s+1}}else if(t.key==="}"||t.key===")")this.selection===""&&this.value[this.selectionStart]===t.key&&(t.preventDefault(),this.selectionStart=++this.selectionEnd);else if(t.key==="Enter"&&this.selection===""&&!t.ctrlKey){t.preventDefault();let r=this.selectionStart,s=/[ \t]*/y;s.lastIndex=this.value.lastIndexOf(`
`,r-1)+1;let c=(n=(i=s.exec(this.value.substring(0,r)))===null||i===void 0?void 0:i[0])!==null&&n!==void 0?n:"";this.value=this.value.substring(0,r)+`
`+c+this.value.substring(r),this.selectionStart=this.selectionEnd=r+1+(c==null?void 0:c.length)}}expandSelectionToLine(){this.selectionStart=this.value.lastIndexOf(`
`,this.selectionStart)+1,this.selectionEnd=(this.value+`
`).indexOf(`
`,this.selectionEnd-1)+1}replaceSelection(t,i){let n=this.selectionStart,r=this.selectionEnd,s=this.selection.replace(t,i);this.value=this.value.substring(0,n)+s+this.value.substring(r),this.selectionStart=n,this.selectionEnd=n+s.length}autosize(){this.element.isConnected&&(this.element.style.height="auto",this.element.style.height=this.element.scrollHeight+"px")}};function re(h,t){let i={m:h,i:t},n=JSON.stringify(i).split("").map(s=>{var c;return s.codePointAt(0)>127?"\\u"+((c=s.codePointAt(0))===null||c===void 0?void 0:c.toString(16).padStart(4,"0")):s});return"#"+btoa(n.join(""))}function ge(h){h=h.replace(/^#/,"");let t=JSON.parse(atob(h));return{munger:t.m,input:t.i}}var G=class extends Q{constructor({timeout:t}){super(e("div",Object.assign({class:"notification"},{children:e("a",Object.assign({class:"notification-close",onclick:()=>this.dismiss()},{children:"\u2716"}),void 0)}),void 0));t&&setTimeout(()=>this.dismiss(),t)}dismiss(){this.element.isConnected&&this.element.remove()}};var be="MungerSource",ye="MungerDoc",Ce=q(`
	( ! format munger
		/^(?: |\\t)*(\\)|})/m => { 
			dec(indent) 
			"\\t" get(indent) rep $1
		}
		/^(?: |\\t)*/m => { "\\t" get(indent) rep }
		/!.*/ => ()
		/\\(|{/ => fx { inc(indent) }
		/\\)|}/ => fx { dec(indent) }
		/(["'\\/])(\\\\.|.)*?\\1/ => ()
		/(?: |\\t)+$/m => ""
	)`).munger,he=class extends w{constructor(){super(l("div",{children:[e("h1",Object.assign({ref:"mungeTitle",id:"app-title"},{children:"Text Munge"}),void 0),l("div",Object.assign({id:"app-inputs"},{children:[l("div",{children:[l("h2",{children:["Munger Source \xA0",l("small",Object.assign({class:"faint"},{children:["(",e("kbd",{children:"F2"},void 0),")"]}),void 0),"\xA0",e("small",{children:e("a",Object.assign({href:"?docs",target:"_blank"},{children:"?"}),void 0)},void 0),"\xA0",e("small",{children:e("a",Object.assign({href:"?",target:"_blank"},{children:"New"}),void 0)},void 0)]},void 0),e(ne,{allowComments:!0,ref:"code"},void 0),e("div",{ref:"codeError",class:"error",hidden:!0},void 0)]},void 0),l("div",{children:[l("h2",{children:["Input Document \xA0",l("small",Object.assign({class:"faint"},{children:["(",e("kbd",{children:"F4"},void 0),")"]}),void 0),"\xA0",l("button",Object.assign({onclick:()=>this.munge()},{children:["\u25B6 Munge ",e("small",{children:"(Ctrl + \u21B2)"},void 0)]}),void 0)]},void 0),e(ne,{ref:"input"},void 0)]},void 0)]}),void 0),l("div",Object.assign({ref:"outputPanel",hidden:!0},{children:[l("h2",{children:["Output ",e("button",Object.assign({onclick:()=>this.copyOutput()},{children:"\u29C9 Copy"}),void 0)]},void 0),e("div",{ref:"output",id:"output"},void 0)]}),void 0),e("div",{id:"notification-area",ref:"notificationArea"},void 0)]},void 0));this.loadState(),this.loadPermaLink(),document.addEventListener("keydown",t=>{if(t.key==="Enter"&&t.ctrlKey)this.munge();else if(t.code==="KeyS"&&t.ctrlKey)this.savePermaLink();else if(t.key==="F2")this.code.focus();else if(t.key==="F4")this.input.focus();else if(t.code==="KeyF"&&t.ctrlKey&&t.shiftKey)this.code.value=L(this.code.value,Ce,new Map),this.code.focus();else return;t.preventDefault()})}get code(){return this.refs.code}get input(){return this.refs.input}get outputPanel(){return this.refs.outputPanel}get output(){return this.refs.output}get notificationArea(){return this.refs.notificationArea}mounted(){this.code.autosize(),this.input.autosize()}copyOutput(){let t=document.createRange();t.selectNodeContents(this.output);let i=getSelection();i&&(i.removeAllRanges(),i.addRange(t)),navigator.clipboard.writeText(this.refs.output.innerText)}saveState(){sessionStorage.setItem(be,this.code.value),sessionStorage.setItem(ye,this.input.value)}loadState(){let t=sessionStorage.getItem(be);t&&(this.code.value=t);let i=sessionStorage.getItem(ye);i&&(this.input.value=i)}codeChanged(){this.refs.codeError.hidden=!0}munge(){this.saveState();let t=new Date;try{let i=q(this.code.value);this.refs.codeError.hidden=!0;let n=L(this.input.value,i.munger,i.named);this.refs.output.innerText=n,this.refs.outputPanel.hidden=!1;let r=l(G,Object.assign({timeout:5e3},{children:["Munging complete in ",new Date().valueOf()-t.valueOf()," ms."]}),void 0);this.notificationArea.append(r.element)}catch(i){i instanceof ie?(this.refs.codeError.innerText=`${i.line}:${i.column} ${i.message}`,this.code.focus(),this.code.selectionStart=i.position,this.code.selectionEnd=i.position+1):this.refs.codeError.innerText=i==null?void 0:i.toString(),this.refs.codeError.hidden=!1;let n=e(G,Object.assign({timeout:5e3},{children:"Munging failed."}),void 0);this.notificationArea.append(n.element);return}}savePermaLink(){let t=location.hash=re(this.code.value,this.input.value),i=()=>{navigator.clipboard.writeText(t),n.refs.check.hidden=!1},n=l(G,Object.assign({timeout:5e3},{children:[e("a",Object.assign({href:t},{children:"Permalink"}),void 0)," generated. "," ",e("span",Object.assign({ref:"check",hidden:!0},{children:"\u2714"}),void 0),e("button",Object.assign({onclick:i},{children:"\u29C9 Copy"}),void 0)]}),void 0);this.notificationArea.append(n.element)}loadPermaLink(){try{if(location.hash.length<=1)return;{let t=ge(location.hash);this.code.value=t.munger,this.input.value=t.input}}catch(t){console.error(t)}}};var{munger:xe}=q(`
#( ! dedent
	/^(\\s*\\n)+/ => ""
	fx /^\\s+/m => { get(indent) _ len min set(indent) }
	/.+/ => { _ get(indent) skip }
)`),v=class extends w{constructor(t){super(l("aside",{children:[e("h4",{children:"Example"},void 0),l("div",Object.assign({class:"example"},{children:[l("div",{children:[e("h5",{children:"Input"},void 0),e("pre",{ref:"input"},void 0)]},void 0),l("div",{children:[e("h5",{children:"Munger"},void 0),e("pre",{ref:"munger"},void 0)]},void 0),l("div",{children:[e("h5",{children:"Output"},void 0),e("pre",{ref:"output"},void 0)]},void 0)]}),void 0),e("a",Object.assign({ref:"permalink"},{children:"Try it \u{1F855}"}),void 0)]},void 0));let i=L(t.input,xe),n=L(t.munger,xe);this.refs.munger.innerText=n,this.refs.input.innerText=i;let{munger:r,named:s}=q(t.munger);this.refs.output.innerText=L(i,r,s),this.permalink.href="?"+re(n,i)}get permalink(){return this.refs.permalink}};var me=class extends w{constructor(){super(l("article",{children:[e("h1",{children:"Text Munge Docs"},void 0),l("section",{children:[e("p",{children:"Munging is about manipulating text."},void 0),l("ol",{children:[e("li",{children:"You have an input document as a string."},void 0),e("li",{children:"You apply a munger."},void 0),e("li",{children:"You get an output document as a string."},void 0)]},void 0),e("p",{children:"A simple munger might extract email addresses. A fancy munger could convert CSV to JSON. Some things work better than others. Let's look at an example."},void 0),e(v,{input:"Hello world",munger:'/o/ => "u"'},void 0),e("h2",Object.assign({id:"munger"},{children:"Mungers"}),void 0),l("p",{children:["A ",e("dfn",{children:"munger"},void 0)," takes text as input. Some can optionally take other context information as well. It produces text as output. There are several types of mungers."]},void 0),l("ul",{children:[e("li",{children:e("a",Object.assign({href:"#rule"},{children:"Rule"}),void 0)},void 0),e("li",{children:e("a",Object.assign({href:"#ruleset"},{children:"Ruleset"}),void 0)},void 0),e("li",{children:e("a",Object.assign({href:"#literal"},{children:"String"}),void 0)},void 0),e("li",{children:e("a",Object.assign({href:"#repeater"},{children:"Repeater"}),void 0)},void 0),e("li",{children:e("a",Object.assign({href:"#effects"},{children:"Side-effect decorator"}),void 0)},void 0),e("li",{children:e("a",Object.assign({href:"#last"},{children:"Last decorator"}),void 0)},void 0),e("li",{children:e("a",Object.assign({href:"#proc"},{children:"Proc"}),void 0)},void 0),e("li",{children:e("a",Object.assign({href:"#named"},{children:"Named Reference"}),void 0)},void 0)]},void 0)]},void 0),e("h2",Object.assign({id:"rule"},{children:"Rules"}),void 0),e("section",{children:l("p",{children:["A ",e("dfn",{children:"rule"},void 0)," consists of a locator and a munger. They go in that order with ",e("code",{children:"=>"},void 0)," in between them."]},void 0)},void 0),e("h2",Object.assign({id:"locator"},{children:"Locators"}),void 0),e("h3",{children:"Literal locator"},void 0),l("section",{children:[l("p",{children:["A ",e("dfn",{children:"locator"},void 0)," finds some particular substring of the input to manipulate. There are three kinds. The simplest locator is the literal. It's enclosed in single quotes."]},void 0),e(v,{input:`Once you munge,
you never go back`,munger:`' ' => ""`},void 0)]},void 0),e("h3",{children:"RegExp locator"},void 0),l("section",{children:[l("p",{children:["There are also ",e("dfn",{children:"regular expression locators"},void 0),", using mostly javascript syntax. The ",e("code",{children:"ism"},void 0)," flags are supported. The ",e("code",{children:"g"},void 0)," flag is implied.\xA0"]},void 0),e(v,{input:"abc 123 def 456",munger:'/\\d/ => "_"'},void 0)]},void 0),e("h3",{children:"Named value locator"},void 0),l("section",{children:[l("p",{children:["The fanciest of the locators is the ",e("dfn",{children:"named value locator"},void 0),". This finds an occurrence of a named value stored by a ",e("a",Object.assign({href:"#proc"},{children:"proc"}),void 0),". The actual value to match is resolved at the start of the start of the enclosing ",e("a",Object.assign({href:"#ruleset"},{children:"ruleset"}),void 0)," or other munger."]},void 0),e(v,{input:"f->m:buffer",munger:`
						(
							/(w)->(w)/ => fx { 
								$1 set(find) 
								$2 set(replace) 
							}
							/.+/ => 
								! we use this extra indirection
								! to delay resolution of get(find)
								get(find) => { get(replace) }
						)`},void 0)]},void 0),e("h2",Object.assign({id:"literal"},{children:"Literal"}),void 0),l("section",{children:[l("p",{children:["A ",e("dfn",{children:"literal munger"},void 0)," is the simplest type of munger. It's a string literal in double quotes. Single quotes are for locators. Double quotes are for mungers. At the top level, this is generally useless. Check out this example.  Every input becomes the same output."]},void 0),e(v,{input:"whatever, a bunch of text",munger:'"useless"'},void 0)]},void 0),e("h2",Object.assign({id:"ruleset"},{children:"Rulesets"}),void 0),l("section",{children:[l("p",{children:["A ",e("dfn",{children:"ruleset"},void 0)," consists of one or more rules. By default, they are applied in document order. Munging proceeds from beginning to end of the input document. Matching rules are applied for each match encountered. A default ruleset consists of zero or more rules contained in ",e("code",{children:"( [rules here] )"},void 0),". An empty set of parenthesis is a no-op munger, which is occasionally useful."]},void 0),e(v,{input:`
							1. abc
							2. ab
							3. bc`,munger:`
							(
								'ab' => "X"
								'bc' => "Y"
							)`},void 0)]},void 0),e("h2",Object.assign({id:"first"},{children:"First-only rulesets"}),void 0),l("section",{children:[l("p",{children:["A ",e("dfn",{children:"first-only ruleset"},void 0)," applies its rules differently. It only applies only a certain number of rules, scanning in document order. After the specified number of rule applications are done, no further munging is performed. First-only rulesets are expressed by adding a preceding number: ",e("code",{children:"1( [rules here] )"},void 0)]},void 0),e(v,{input:"foo foo foo",munger:`2( 'foo' => "bar" )`},void 0)]},void 0),e("h2",Object.assign({id:"sequence"},{children:"Sequences"}),void 0),l("section",{children:[l("p",{children:["A ",e("dfn",{children:"sequence"},void 0)," is an orderd list of mungers. Rather than scanning the document from start to end, a sequence iterates over rules in declaration order. It applies each munger to the entire document in declaration order. This means that subsequent mungers are able to see the output from the previous rules. These use a ",e("code",{children:"#"},void 0)," prefix."]},void 0),e(v,{input:"food",munger:`
						#( 
							'foo' => "bar"
							'ard' => "icycle"
						)`},void 0),l("p",{children:["It's also possible to combine a sequenced and first-only ruleset this way. These apply only the first rule to match, in declaration order, instead of document order. The prefix is like ",e("code",{children:"1#"},void 0),"."]},void 0)]},void 0),e("h2",Object.assign({id:"repeater"},{children:"Repeaters"}),void 0),l("section",{children:[l("p",{children:["A ",e("dfn",{children:"repeater"},void 0)," is a decorated munger. You can precede any other munger with a ",e("code",{children:"@"},void 0),", and it will become a repeater.",e("code",{children:"@"},void 0)," like a wheel to me, just rolling and rolling. A repeater applies repeatedly to its input until a fixed point is reached. It's not too hard to make an infinite loop with these."]},void 0),e(v,{input:"a{{}{{}}}b",munger:`@'{}' => ""`},void 0)]},void 0),e("h2",Object.assign({id:"last"},{children:"Last match"}),void 0),l("section",{children:[l("p",{children:["You can apply a rule only to the last match of its locator using a ",e("dfn",{children:"last"},void 0),". This can only be applied to a single rule."]},void 0),e(v,{input:"foo foo foo",munger:`last('foo' => "bar")`},void 0)]},void 0),e("h2",Object.assign({id:"comment"},{children:"Comments"}),void 0),l("section",{children:[l("p",{children:["You can add a ",e("dfn",{children:"comment"},void 0)," to the end of any line in a munger. Comments start with a ",e("code",{children:"!"},void 0),"."]},void 0),e(v,{input:"loool             ",munger:'/\\s+$/ => "" ! trailing whitespace'},void 0)]},void 0),e("h2",Object.assign({id:"proc"},{children:"Procs"}),void 0),l("section",{children:[l("p",{children:["Now it's time for the big guns. A ",e("dfn",{children:"proc"},void 0)," is an arbitrary piece of logic inside of ",e("code",{children:"{ }"},void 0)," curly braces. It's a concatenative stack-based language fully enclosed inside the text munging language. Ok, let's just look at some code."]},void 0),e(v,{input:"Hello World",munger:`
							( ! toggle case
								/[a-z]/ => { _ upper }
								/[A-Z]/ => { _ lower }
							)`},void 0),l("p",{children:["There's a ",e("a",Object.assign({href:"?proc"},{children:"whole separate page"}),void 0)," about the details of the proc language."]},void 0)]},void 0),e("h2",Object.assign({id:"effects"},{children:"Side effects"}),void 0),l("section",{children:[l("p",{children:["There's a ",e("dfn",{children:"side effect"},void 0)," decoration you can use on any munger if you only want to use it for side effects. This is generally most useful if you have procs that are setting variables or something that you're going to use later. Precede any munger with `fx`, and it won't actually do any replacement."]},void 0),e(v,{input:`
							first
							middle
							last`,munger:`
							#(
								fx /.+/ => { _ len set(lastlen) } ! matches every line
								1( /$/m => { " Length of last line: " get(lastlen) } )
							)`},void 0)]},void 0),e("h2",Object.assign({id:"named"},{children:"Named munger declarations"}),void 0),l("section",{children:[l("p",{children:["Prior to the munger, you can create one or more ",e("dfn",{children:"named munger declarations"},void 0),". These can be referred to later. These are ",e("code",{children:"def(name)"},void 0)," followed by a munger. You can invoke them using ",e("code",{children:"do(name)"},void 0),"."]},void 0),e(v,{input:"abc123def567",munger:`
							def(paren) { "(" _ ")" }
							( ! enclose runs in parens
								/\\d+/     => do(paren)
								/[a-z]+/i => do(paren)
							)`},void 0)]},void 0),l("p",{children:["Did you know? You can press ",e("kbd",{children:"Ctrl"},void 0)," + ",e("kbd",{children:"S"},void 0)," to generate a permalink.",e("kbd",{children:"Ctrl"},void 0)," + ",e("kbd",{children:"/"},void 0)," is block comment.",e("kbd",{children:"Tab"},void 0)," is block indent.",e("kbd",{children:"Ctrl"},void 0)," + ",e("kbd",{children:"Shift"},void 0)," + ",e("kbd",{children:"F"},void 0)," is munger auto-indent."]},void 0)]},void 0))}};var pe=class extends w{constructor(){super(l("article",{children:[e("h1",{children:"Munging Procs"},void 0),l("p",{children:["Procs operate on a stack.  All values are strings. Some instructions operate on numbers, but they're really just strings like ",e("code",{children:'"123"'},void 0),". There are two namespaces for variables. One for normal string variables, and another for arrays of strings."]},void 0),e("p",{children:"A proc is just one type of munger.  All mungers produce a single string as output. At the conclusion of a proc, all the values in the stack are concatenated together to produce the output."},void 0),l("p",{children:["Certain noted instructions operate on blocks. Blocks are groups of instructions enclosed in curly braces. ",e("code",{children:"{ }"},void 0),"Blocks can be nested."]},void 0),l("p",{children:["Some instructions take a named variable in parentheses like ",e("code",{children:"set(x)"},void 0),". This is the equivalent of ",e("code",{children:'"x" set'},void 0),". This allows a crude form of indirection by allowing non-constant variable names."]},void 0),e("h2",{children:"Proc Instructions"},void 0),l("dl",{children:[e("dt",{children:e("code",{children:"_"},void 0)},void 0),e("dd",{children:"Push the current matched value."},void 0),e("dt",{children:e("code",{children:'"abc"'},void 0)},void 0),e("dd",{children:"Push a string literal."},void 0),e("dt",{children:e("code",{children:"123"},void 0)},void 0),e("dd",{children:"Push a string literal consisting of digits."},void 0),e("dt",{children:e("code",{children:"$1"},void 0)},void 0),e("dd",{children:"Push the value of the first capture group from a regex locator. Works for other numbers too."},void 0),e("dt",{children:e("code",{children:"group"},void 0)},void 0),e("dd",{children:"Push the value of the nth capture group from a regex locator. n is popped."},void 0),e("dt",{children:e("code",{children:"swap"},void 0)},void 0),e("dd",{children:"Swap the top two values on the stack."},void 0),e("dt",{children:e("code",{children:"copy"},void 0)},void 0),e("dd",{children:"Copy the top value on the stack."},void 0),e("dt",{children:e("code",{children:"drop"},void 0)},void 0),e("dd",{children:"Pop from the stack and throw it in the trash."},void 0),e("dt",{children:e("code",{children:"clear"},void 0)},void 0),e("dd",{children:"Empty the whole stack."},void 0),e("dt",{children:e("code",{children:"len"},void 0)},void 0),e("dd",{children:"Push the length of a string."},void 0),e("dt",{children:e("code",{children:"min"},void 0)},void 0),e("dt",{children:e("code",{children:"max"},void 0)},void 0),e("dd",{children:"Pop two values.  Push the lesser or greater of them, interpreted as numbers."},void 0),e("dt",{children:e("code",{children:"<"},void 0)},void 0),e("dt",{children:e("code",{children:">"},void 0)},void 0),e("dt",{children:e("code",{children:"="},void 0)},void 0),e("dd",{children:"Pop two values.  Push 0 or 1 depending on the comparison of the two."},void 0),e("dt",{children:e("code",{children:"<<"},void 0)},void 0),e("dt",{children:e("code",{children:">>"},void 0)},void 0),e("dt",{children:e("code",{children:"<="},void 0)},void 0),e("dt",{children:e("code",{children:">="},void 0)},void 0),e("dd",{children:"Pop two values.  Push 0 or 1 depending on the comparison of the two, treating them as numbers."},void 0),e("dt",{children:e("code",{children:"+"},void 0)},void 0),e("dt",{children:e("code",{children:"-"},void 0)},void 0),e("dt",{children:e("code",{children:"*"},void 0)},void 0),e("dt",{children:e("code",{children:"/"},void 0)},void 0),e("dt",{children:e("code",{children:"%"},void 0)},void 0),e("dd",{children:"Pop two values.  Push the result of an arithmetic operation."},void 0),e("dt",{children:e("code",{children:"floor"},void 0)},void 0),e("dd",{children:"Pop a number.  Push its numeric floor."},void 0),e("dt",{children:e("code",{children:"not"},void 0)},void 0),e("dd",{children:"Pop a value.  Push 0 if it's truthy, or 1 otherwise."},void 0),e("dt",{children:e("code",{children:"rep"},void 0)},void 0),e("dd",{children:"Pop a repetition count.  Concatenate a popped string that many times."},void 0),e("dt",{children:e("code",{children:"or"},void 0)},void 0),e("dd",{children:"Pop two values. Push the first one if it's truthy.  Otherwise push the second."},void 0),e("dt",{children:e("code",{children:"cat"},void 0)},void 0),e("dd",{children:"Pop a value, then concatenate with the top of the stack"},void 0),e("dt",{children:e("code",{children:"lpad"},void 0)},void 0),e("dt",{children:e("code",{children:"rpad"},void 0)},void 0),e("dd",{children:"Pop a width.  Left- or right-pad a value to the specified width."},void 0),e("dt",{children:e("code",{children:"index"},void 0)},void 0),e("dd",{children:"Pop two values.  Push the index of the first occurrence of the second in the first."},void 0),e("dt",{children:e("code",{children:"upper"},void 0)},void 0),e("dt",{children:e("code",{children:"lower"},void 0)},void 0),e("dd",{children:"Pop a value.  Convert the case and push."},void 0),e("dt",{children:e("code",{children:"take"},void 0)},void 0),e("dt",{children:e("code",{children:"skip"},void 0)},void 0),e("dd",{children:"Pop an index.  Push the left or right substring of a value from that position."},void 0),e("dt",{children:e("code",{children:"ord"},void 0)},void 0),e("dt",{children:e("code",{children:"chr"},void 0)},void 0),e("dd",{children:"Convert between a character and the corresponding unicode codepoint."},void 0),e("dt",{children:e("code",{children:"hex"},void 0)},void 0),e("dt",{children:e("code",{children:"unhex"},void 0)},void 0),e("dd",{children:'Convert between decimal and hexadecimal representation. "255" <-> "ff"  '},void 0),e("dt",{children:e("code",{children:"set(x)"},void 0)},void 0),e("dt",{children:e("code",{children:"get(x)"},void 0)},void 0),e("dd",{children:"Gets or sets a named variable."},void 0),e("dt",{children:e("code",{children:"inc(x)"},void 0)},void 0),e("dt",{children:e("code",{children:"dec(x)"},void 0)},void 0),e("dd",{children:"Increment or decrement a named variable.  Does not touch the stack."},void 0),e("dt",{children:e("code",{children:"cons(x)"},void 0)},void 0),e("dt",{children:e("code",{children:"push(x)"},void 0)},void 0),e("dd",{children:"Pop a value.  Insert it at the beginning or end of a named array."},void 0),e("dt",{children:e("code",{children:"uncons(x)"},void 0)},void 0),e("dt",{children:e("code",{children:"pop(x)"},void 0)},void 0),e("dd",{children:"Push a value removed from the beginning or end of a named array."},void 0),e("dt",{children:e("code",{children:"empty(x)"},void 0)},void 0),e("dd",{children:"Remove all elements from named array."},void 0),e("dt",{children:e("code",{children:"count(x)"},void 0)},void 0),e("dd",{children:"Push the length of a named array."},void 0),e("dt",{children:e("code",{children:"rev(x)"},void 0)},void 0),e("dd",{children:"Reverse a named array in place.  Does not touch the stack."},void 0),e("dt",{children:e("code",{children:"join(x)"},void 0)},void 0),e("dd",{children:"Pop a delimiter.  Use it to join a named array.  Push the result."},void 0),e("dt",{children:e("code",{children:"sort(x)"},void 0)},void 0),e("dd",{children:"Sort a named array.  Does not touch the stack."},void 0),e("dt",{children:l("code",{children:["if ","{ ... } [{ ... }]"]},void 0)},void 0),e("dd",{children:"Pop a condition.  If it's truthy, execute the following condition block.  Otherwise execute the else block, if present."},void 0),e("dt",{children:l("code",{children:["for(x) ","{ ... }"]},void 0)},void 0),l("dd",{children:["Execute a block for each element in a named array.  The element will be accessible from the ",e("code",{children:"_"},void 0)," instruction."]},void 0),e("dt",{children:l("code",{children:["times ","{ ... }"]},void 0)},void 0),e("dd",{children:"Pop a number.  Execute a block that many times."},void 0),e("dt",{children:e("code",{children:"do(x)"},void 0)},void 0),l("dd",{children:["Invoke a named proc, established using a ",e("code",{children:"def(x)"},void 0)," declaration."]},void 0),e("dt",{children:e("code",{children:"dump"},void 0)},void 0),e("dd",{children:"Logs the current state of things to the console."},void 0)]},void 0),e("h2",{children:"Parting Example"},void 0),e("p",{children:"Here's a fancy little number that demonstrates many of these. It indents JSON."},void 0),e(v,{input:`
						{ "kind": "Combobox", "defaultValue": "win-x86", 
						"label": { "$ref": "strings:#/targetRuntime" }, 
						"itemsSource": { "kind": "TargetRuntime", "defaults": 
						[ "win-x86", "win-x64", "win-arm", "osx-x64", 
						"linux-x64", "linux-arm" ], "dependsOn": [ 
						"DeploymentMode.SelectedValue" ] }, "enabled": 
						"true" }`,munger:`
						def(nl) {                 ! macro definition for next line
							"\\n"
							"  " get(depth) rep   ! repeat indent string
						}
						(
							/\\s/ => ""            ! strip pre-existing whitespace
							/"(?:\\\\.|.)*?"/ => () ! don't touch string literals
							':' => ": "           ! single space after colon
							',' => { _ do(nl) }   ! newline after comma
							/{|\\[/ => {           ! open braces
								inc(depth)
								_ do(nl)
							}
							/}|\\]/ => {           ! close braces
								dec(depth)
								do(nl) _ 
							}
						)`},void 0)]},void 0))}};var oe=document.querySelector("main");switch(location.search){case"?docs":let h=new me;oe.append(h.element);break;case"?proc":let t=new pe;oe.append(t.element);break;case"?about":oe.append("Text Munger by Tom Theisen");break;default:let i=new he;i.refs.mungeTitle.title=document.getElementById("build-date").value,oe.append(i.element),i.mounted()}})();
</script>
		<footer class="faint">
			<a target="_blank" href="https://github.com/tomtheisen/munge">text munge</a>
			is inconspicuously ⚡ powered by 
			<a target="_blank"  href="https://github.com/tomtheisen/redactio">redactio</a>
			but i mean it's not like a big deal or anything
		</footer>
	</body>
</html>